@using DevOpsAssistant.Pages
@using Microsoft.Extensions.Localization
@using Microsoft.JSInterop
@inject IStringLocalizer<Help> L
@inject IJSRuntime JS

<MudText Typo="Typo.h4">@L["Heading"]</MudText>
<MudText Typo="Typo.body1">@((MarkupString)L["Intro"].Value)</MudText>

<MudPaper Class="pa-4 mb-4">
    <MudText Typo="Typo.subtitle1">@L["NavHeading"]</MudText>
    <MudStack Row="true" Spacing="2" Wrap="Wrap.Wrap">
        <MudLink Underline="Underline.Always" Class="mx-2" OnClick="@(() => ScrollTo("epics"))">@L["EpicsHeading"]</MudLink>
        <MudLink Underline="Underline.Always" Class="mx-2" OnClick="@(() => ScrollTo("validation"))">@L["ValidationHeading"]</MudLink>
        <MudLink Underline="Underline.Always" Class="mx-2" OnClick="@(() => ScrollTo("quality"))">@L["QualityHeading"]</MudLink>
        <MudLink Underline="Underline.Always" Class="mx-2" OnClick="@(() => ScrollTo("requirements"))">@L["RequirementsPlannerHeading"]</MudLink>
        <MudLink Underline="Underline.Always" Class="mx-2" OnClick="@(() => ScrollTo("releaseNotes"))">@L["ReleaseNotesHeading"]</MudLink>
        <MudLink Underline="Underline.Always" Class="mx-2" OnClick="@(() => ScrollTo("bulkTag"))">@L["BulkTagHeading"]</MudLink>
        <MudLink Underline="Underline.Always" Class="mx-2" OnClick="@(() => ScrollTo("metrics"))">@L["MetricsHeading"]</MudLink>
        <MudLink Underline="Underline.Always" Class="mx-2" OnClick="@(() => ScrollTo("branchHealth"))">@L["BranchHealthHeading"]</MudLink>
        <MudLink Underline="Underline.Always" Class="mx-2" OnClick="@(() => ScrollTo("settings"))">@L["SettingsHeading"]</MudLink>
    </MudStack>
</MudPaper>

<MudPaper Class="pa-6">
    <MudText Typo="Typo.h6" id="epics">@L["EpicsHeading"]</MudText>
    <MudText Typo="Typo.body2">@((MarkupString)L["Epics"].Value)</MudText>
</MudPaper>
<MudPaper Class="pa-6">
    <MudText Typo="Typo.h6" id="validation">@L["ValidationHeading"]</MudText>
    <MudText Typo="Typo.body2">@((MarkupString)L["Validation"].Value)</MudText>
</MudPaper>
<MudPaper Class="pa-6">
    <MudText Typo="Typo.h6" id="quality">@L["QualityHeading"]</MudText>
    <MudText Typo="Typo.body2">@((MarkupString)L["Quality"].Value)</MudText>
</MudPaper>
<MudPaper Class="pa-6">
    <MudText Typo="Typo.h6" id="requirements">@L["RequirementsPlannerHeading"]</MudText>
    <MudText Typo="Typo.body2">@((MarkupString)L["RequirementsPlanner"].Value)</MudText>
</MudPaper>
<MudPaper Class="pa-6">
    <MudText Typo="Typo.h6" id="releaseNotes">@L["ReleaseNotesHeading"]</MudText>
    <MudText Typo="Typo.body2">@((MarkupString)L["ReleaseNotes"].Value)</MudText>
</MudPaper>
<MudPaper Class="pa-6">
    <MudText Typo="Typo.h6" id="bulkTag">@L["BulkTagHeading"]</MudText>
    <MudText Typo="Typo.body2">@((MarkupString)L["BulkTag"].Value)</MudText>
</MudPaper>
<MudPaper Class="pa-6">
    <MudText Typo="Typo.h6" id="metrics">@L["MetricsHeading"]</MudText>
    <MudText Typo="Typo.body2">@((MarkupString)L["Metrics"].Value)</MudText>
</MudPaper>
<MudPaper Class="pa-6">
    <MudText Typo="Typo.h6" id="branchHealth">@L["BranchHealthHeading"]</MudText>
    <MudText Typo="Typo.body2">@((MarkupString)L["BranchHealth"].Value)</MudText>
</MudPaper>
<MudPaper Class="pa-6">
    <MudText Typo="Typo.h6" id="settings">@L["SettingsHeading"]</MudText>
    <MudText Typo="Typo.body2">
        @((MarkupString)string.Format(L["Settings"], GuideLinkHtml))
    </MudText>
</MudPaper>

@code {
    private async Task ScrollTo(string id)
    {
        await JS.InvokeVoidAsync("scrollToId", id);
    }

    private string GuideLinkHtml =>
        $"<a href='https://learn.microsoft.com/azure/devops/organizations/accounts/use-personal-access-tokens-to-authenticate' target='_blank'>{L["GuideLinkText"]}</a>";
}
